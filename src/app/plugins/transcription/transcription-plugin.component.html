<div class="header" #header *ngIf="pluginConfiguration && pluginConfiguration.data.title" #headerBlock>
    <div class="resume">
        <h3 class="heading">{{pluginConfiguration.data?.title}}</h3>
        <p *ngIf="pluginConfiguration.data?.description">{{pluginConfiguration.data?.description}}</p>
    </div>
</div>

<div *ngIf="transcriptions && transcriptions.length>0; then transcriptionBlock; else emptyBlock"></div>
<div class="search-block" (keyup)="handleShortcut($event)">
    <div class="search-text">
        <div class="search-icon" (click)="searchWord(searchText.value);searching=true" [ngClass]="{'hidden' : searching === true}">
            <svg class="amalia-svg-search-size icon">
                <use [attr.xlink:href]="'assets/svgs/symbol/svg/sprite.symbol.svg#search'"></use>
            </svg>
        </div>
        <div class="search-result" *ngIf="listOfSearchedNodes?.length >= 0 && searching === true">
                {{index}} / {{listOfSearchedNodes?.length}}  
                <svg class="amalia-svg-clear-size icon" (click)="clearSearchList();active = false">
                        <use [attr.xlink:href]="'assets/svgs/symbol/svg/sprite.symbol.svg#clear'"></use>
                </svg>
        </div>
        <input type="text"
               value= {{pluginConfiguration.data.label}}
               (click)="searchText.value ='';active= true"
               [ngClass]="{'active' : active === true}"
               #searchText>
    </div>
    <div class="controls" [ngClass]="{'show' : listOfSearchedNodes?.length > 0}">
        <div class="up" (click)="scrollToSearchedWord('up')">
            <svg class="amalia-svg-up-size icon">
                <use [attr.xlink:href]="'assets/svgs/symbol/svg/sprite.symbol.svg#up'"></use>
            </svg>
        </div>
        <div class="down" (click)="scrollToSearchedWord('down')">
            <svg class="amalia-svg-up-size icon">
                <use [attr.xlink:href]="'assets/svgs/symbol/svg/sprite.symbol.svg#down'"></use>
            </svg>
        </div>
    </div>
    <div class="message">
        <span *ngIf="listOfSearchedNodes?.length > 0; else elseBlock">{{listOfSearchedNodes?.length}} mot(s)
        correspond aux terme recherch√©.
    </span>
        <ng-template #elseBlock><span
                *ngIf="listOfSearchedNodes?.length === 0">Aucun mot ne correspond aux termes de recherche</span>
        </ng-template>
    </div>
</div>
<ng-template #transcriptionBlock>
    <div class="transcription" #transcriptionElement (scroll)="handleScroll(true)">
        <div class="segment" *ngFor="let t of transcriptions" [attr.data-tcin]="t.tcIn" [attr.data-tcOut]="t.tcOut">
            <div class="title">{{t.label}}</div>
            <div class="timecode" (click)="callSeek(t.tcIn)">
                <div class="tcin">{{t.tcIn|tcFormat:tcDisplayFormat}}</div>
                <div class="separator"></div>
                <div class="tcout">{{t.tcOut|tcFormat:tcDisplayFormat}}</div>
            </div>
            <div class="progress-bar" [ngStyle]="{width: '0%'}" *ngIf="displayProgressBar"></div>
            <div class="text" (click)="seekToWord($event)">
                <span *ngIf="t.subLocalisations && t.subLocalisations.length>0; then subLocalisationBlock; else wordBlock"></span>
                <ng-template #subLocalisationBlock>
                    <span *ngFor="let w of t.subLocalisations"
                          class="w"
                          [attr.data-tcin]="w.tcIn"
                          [attr.data-tcOut]="w.tcOut" [innerHTML]="w.text+' ' | sanitizeHtml: 'html'"></span>
                </ng-template>
                <ng-template #wordBlock><span class="w" [attr.data-tcin]="t.tcIn"
                                              [attr.data-tcOut]="t.tcOut"
                                              [innerHTML]="t.text | sanitizeHtml: 'html'"></span>
                </ng-template>
            </div>
        </div>
    </div>
    <div class="auto-scroll" tooltip='{{pluginConfiguration.data.labelSynchro}}' [ngClass]="{'active' : displaySynchro}"(click)="scrollToSelectedSegment()">
        <svg class="amalia-svg-auto-scroll-size icon">
            <use [attr.xlink:href]="'assets/svgs/symbol/svg/sprite.symbol.svg#refresh'"></use>
        </svg>
    </div>
</ng-template>
<ng-template #emptyBlock>Error to find transcription</ng-template>
